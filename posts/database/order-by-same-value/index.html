<!DOCTYPE html><html><head><style data-href="/styles.1e48cec9da6ed441ace7.css">html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,nav,section{display:block}summary{display:list-item}figure{margin:0}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}audio,canvas,video{display:inline-block}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:focus{outline:thin dotted}a:active,a:hover{outline:0}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:700}dfn{font-style:italic}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border:0;vertical-align:middle}svg:not(:root){overflow:hidden}blockquote,q{quotes:none}blockquote:after,blockquote:before,q:after,q:before{content:"";content:none}button,input,optgroup,select,textarea{font:inherit;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}textarea{overflow:auto}optgroup{font-weight:700}progress{display:inline-block;vertical-align:baseline}table{border-collapse:collapse;border-spacing:0}html{font-family:Roboto,Helvetica,sans-serif;font-size:112.5%;height:100%;min-height:100%}body{background:#fff;color:#555e69;line-height:1.66667}a{border-bottom:2px solid #1de2bc;color:#33383f;transition:border .3s ease,color .3s ease}a,a:hover{text-decoration:none}a:hover{border-color:currentColor}h1,h2,h3,h4,h5,h6{color:#33383f;font-weight:700;line-height:1.2;margin:1.66667rem 0 .83333rem;text-rendering:optimizeLegibility}h1:first-child,h2:first-child,h3:first-child,h4:first-child,h5:first-child,h6:first-child{margin-top:0}h1{font-size:2.22222em}h2{font-size:1.88889em}h3{font-size:1.55556em}h4{font-size:1.33333em}h5{font-size:1.11111em}h6{font-size:.88889em;letter-spacing:.0625em;text-transform:uppercase}address,p{margin:0 0 1.66667em}address{font-style:italic}ins,mark{background:#fff9c6;color:#33383f;padding:0 3px;text-decoration:none}code,pre{font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:.88889rem}pre{background-color:#f7f8f9;border:1px solid #e9ebed;border-radius:5px;color:#33383f;margin:1.66667rem 0;overflow:auto;padding:1.33333em;position:relative;white-space:pre}pre:first-child{margin-top:0}blockquote{border-bottom:1px solid #33383f;border-top:3px solid #33383f;font-size:1.88889em;line-height:1.25;margin:2rem 0;padding-bottom:1.66667rem;padding-top:1.33333rem}blockquote:first-child{margin-top:0}blockquote p{margin-bottom:.5em}blockquote p:last-child{margin-bottom:0}blockquote cite,blockquote small{color:#959ea9;display:block;font-size:.52941em;font-style:normal;font-weight:400;line-height:1.5;margin-top:1em}blockquote cite:last-child,blockquote small:last-child{margin-bottom:0}dl{margin:0}dt{font-weight:700}dd,ol,ul{margin:0 0 1.66667em}ol,ul{padding:0 0 0 1.33333em}li>ol,li>ul{margin-bottom:0}hr{background-color:#e9ebed;border:0;height:1px;margin:1.66667em 0}table{border-bottom:1px solid #e9ebed;line-height:1.5;margin:0 0 1.66667rem;max-width:100%;width:100%}caption,table{text-align:left}caption{color:#959ea9;font-size:.88889rem;font-style:normal;margin-bottom:1em}td,th{border-top:1px solid #e9ebed;padding:.5em 5px}th{color:#33383f;font-weight:700}.responsive-table{display:block;overflow-x:auto;width:100%}label{color:#33383f;display:inline-block;line-height:1.5;margin-bottom:.25em}input[type=email],input[type=number],input[type=password],input[type=search],input[type=tel],input[type=text],input[type=url],select,textarea{background:#f7f8f9;border:1px solid #e9ebed;border-radius:5px;box-shadow:none;box-sizing:border-box;color:#555e69;display:inline-block;font-size:16px;font-weight:400;line-height:1.5;max-width:100%;padding:.5em 10px;vertical-align:baseline;width:100%}input[type=email]:focus,input[type=number]:focus,input[type=password]:focus,input[type=search]:focus,input[type=tel]:focus,input[type=text]:focus,input[type=url]:focus,select:focus,textarea:focus{outline:0}.form-group{margin-bottom:1em}.form-submit{margin-top:1.66667em}.form-select-wrap{font-size:16px;position:relative}.form-select-wrap select{-webkit-appearance:none;-moz-appearance:none;padding-right:25px}.form-select-wrap select:focus{outline:0}.form-select-wrap:after,.form-select-wrap:before{border:.3125em solid transparent;box-sizing:border-box;content:"";position:absolute;right:10px;top:50%;z-index:1}.form-select-wrap:before{border-top-color:#959ea9;margin-top:.125em}.form-select-wrap:after{border-bottom-color:#959ea9;margin-top:-.75em}.form-checkbox{padding-left:24px;position:relative}.form-checkbox input[type=checkbox]{height:1.5em;left:0;position:absolute;top:0}:-ms-input-placeholder{color:#959ea9}::placeholder{color:#959ea9}.button,button,input[type=button],input[type=reset],input[type=submit]{background:#1de2bc;border:2px solid #1de2bc;border-radius:30px;box-sizing:border-box;color:#fff;display:inline-block;font-size:14px;letter-spacing:.075em;line-height:1.2;padding:.75714em 35px;text-align:center;text-decoration:none;text-transform:uppercase;transition:.3s ease}.button:active,.button:focus,.button:hover,button:active,button:focus,button:hover,input[type=button]:active,input[type=button]:focus,input[type=button]:hover,input[type=reset]:active,input[type=reset]:focus,input[type=reset]:hover,input[type=submit]:active,input[type=submit]:focus,input[type=submit]:hover{background:transparent;border-color:#1de2bc;box-shadow:0 0 1px .5em rgba(29,226,188,.2);color:#33383f;outline:0}.button-icon{align-items:center;display:inline-flex;font-size:1em;height:2.33333em;justify-content:center;line-height:2.33333em;width:2.33333em}#menu-toggle,.button-icon{padding:0;position:relative}#menu-toggle{background:0;border:0;box-shadow:none;color:inherit;height:30px;width:30px}embed,iframe,object,video{max-width:100%}.js-reframe{margin:0 0 1.66667em}img{height:auto;max-width:100%}.block img,.post-content img,.post-image img{border-radius:5px}.screen-reader-text,.site-logo+.site-identity .site-description,.site-logo+.site-identity .site-title{border:0;clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;padding:0;position:absolute!important;width:1px}.underline{position:relative}.underline:after{border-left:30px solid #1de2bc;box-shadow:inset 0 1px 0 0 #e9ebed;display:block;content:"";height:3px;margin-top:1rem}.post-content:after{clear:both}.post-content:after,.post-content:before{content:"";display:table}@media only screen and (max-width:600px){html{font-size:100%}h1{font-size:2em}h2{font-size:1.77778em}blockquote{font-size:1.55556em}}.icon{color:inherit;fill:currentColor;flex-shrink:0;height:1em;line-height:1;width:1em}.icon-menu{color:inherit;height:2px;top:50%;transform:translateY(-50%);transition:width .15s ease}.icon-menu,.icon-menu:after,.icon-menu:before{background:currentColor;position:absolute;right:0;width:20px}.icon-menu:after,.icon-menu:before{content:"";height:100%;transition:transform .15s ease}.icon-menu:before{top:5px}.icon-menu:after{top:-5px}.menu--opened .icon-menu{width:35px}.menu--opened .icon-menu:before{transform:translate3d(5px,0,0) rotate(-45deg) scaleX(.78)}.menu--opened .icon-menu:after{transform:translate3d(5px,0,0) rotate(45deg) scaleX(.78)}.icon-arrow-left,.icon-arrow-right{height:2px;width:16px}.icon-arrow-left,.icon-arrow-right,.icon-arrow-up{background:currentColor;color:inherit;left:50%;position:absolute;top:50%;transform:translate(-50%,-50%)}.icon-arrow-up{height:16px;width:2px}.icon-arrow-left:before,.icon-arrow-right:before,.icon-arrow-up:before{border-color:currentColor;border-style:solid;content:"";position:absolute;height:8px;width:8px}.icon-arrow-left:before{border-width:2px 0 0 2px;left:-1px;top:1px;transform:rotate(-45deg);transform-origin:top left}.icon-arrow-right:before{border-width:2px 2px 0 0;right:-1px;top:1px;transform:rotate(45deg);transform-origin:top right}.icon-arrow-up:before{border-width:2px 2px 0 0;right:1px;top:-1px;transform:rotate(-45deg);transform-origin:top right}@keyframes fadeInDown{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.site-content{animation-duration:.7s;animation-fill-mode:both;animation-name:fadeInDown}.inner{max-width:1080px}.inner,.inner-sm{margin-left:auto;margin-right:auto}.inner-sm{max-width:760px}.site{overflow:hidden;position:relative}.site-content,.site-header-inside,.site-nav-inside{padding-left:3vw;padding-right:3vw}.site-content{padding-bottom:2.5em;padding-top:2.5em}@media only screen and (min-width:801px){.site-content{margin-left:30vw;padding-bottom:3.33333em;padding-top:3.33333em}}@media only screen and (min-width:1001px){.site-content{margin-left:300px}}.site-main{margin-bottom:3.33333em}.style-simple .post-feed,.style-simple .post-image{margin-left:auto;margin-right:auto;max-width:760px}.site-header{background:#fff;border-bottom:1px solid #e9ebed;color:#555e69}.site-header-inside{padding-bottom:1.11111em;padding-top:1.11111em}.site-branding{align-items:center;display:flex;font-size:1rem}.site-logo{flex:0 0 auto;margin:0 10px 0 0}.site-logo a{border:0}.site-logo img{max-height:45px}.profile{flex:0 0 auto;margin:0 15px 0 0}.profile a{border:0}.profile .avatar{border:2px solid #1de2bc;box-shadow:0 0 1px 7px rgba(29,226,188,.2);border-radius:100%;display:block;-o-object-fit:cover;object-fit:cover;height:45px;width:45px}.site-title{color:#33383f;font-size:1.11111rem;font-weight:700;line-height:1;margin:0}.site-title a{border:0;color:inherit}.site-description{font-size:12px;line-height:1;margin:.25em 0 0}#menu-toggle{margin-left:auto;z-index:100}.site-navigation{background:#fff;bottom:0;box-sizing:border-box;-webkit-overflow-scrolling:touch;position:absolute;right:-100%;top:0;transition:right .3s,visibility 0s .3s;visibility:hidden;width:100%;z-index:90}.site-nav-wrap{height:100%;overflow:auto;-webkit-overflow-scrolling:touch;position:relative}.site-nav-inside{padding-bottom:4em;padding-top:4em}.menu{font-size:14px;line-height:1.5;letter-spacing:.15em;list-style:none;margin:0;padding:0;text-transform:uppercase}.menu-item{border-top:1px solid #e9ebed;padding:.5em 0}.menu-item.current-menu-item{color:#1de2bc}.menu-item:not(.menu-button):last-child{border-bottom:1px solid #e9ebed}.menu-item.menu-button{padding:1em 0}.menu-item.menu-button+.menu-button{border-top:0;padding-top:0}.menu-item .button{padding-bottom:.54286em;padding-top:.54286em}.menu-item a:not(.button){border:0;color:inherit}.menu-item a:not(.button):hover{color:#1de2bc}.social-links{align-items:center;display:flex;flex-wrap:wrap;margin-top:1.66667em}.social-links a{color:inherit;margin:0 10px .5em 0}.social-links a:not(.button){border:0;font-size:16px}.social-links a:not(.button):hover{color:#1de2bc}.social-links a.button-icon{background:transparent;border:1px solid #e9ebed;font-size:16px;height:2em;line-height:2em;width:2em}.social-links a.button-icon:active,.social-links a.button-icon:focus,.social-links a.button-icon:hover{background:#1de2bc;border-color:#1de2bc;box-shadow:0 0 1px 5px rgba(29,226,188,.2);color:#fff}.site-header.dark{border:0;color:#959ea9}.site-header.dark,.site-header.dark .site-navigation{background:#33383f}.site-header.dark .site-title{color:#fff}.site-header.dark .menu-item .button:active,.site-header.dark .menu-item .button:focus,.site-header.dark .menu-item .button:hover{color:#1de2bc}.site-header.dark .menu-item,.site-header.dark .social-links .button-icon{border-color:#555e69}.site-header.dark .social-links .button-icon:hover{border-color:#1de2bc}@media only screen and (min-width:801px){.site-header{border-bottom:0;border-right:1px solid #e9ebed;height:100%;left:0;position:fixed;text-align:center;top:0;width:30vw}.site-header-wrap{height:100%;overflow:auto;-webkit-overflow-scrolling:touch;position:relative}.site-header-inside{padding-bottom:3.33333em;padding-top:3.33333em}.site-branding{flex-direction:column}.site-identity{margin-bottom:1.66667em;padding:0}.site-logo{margin:0 0 1.66667em}.site-logo img{max-height:100px}.profile{margin:0 0 1.66667em}.profile .avatar{border-width:3px;box-shadow:0 0 1px 11px rgba(29,226,188,.2);-o-object-fit:cover;object-fit:cover;height:100px;width:100px}.site-title{font-size:1.33333rem;line-height:1.2}.site-description{font-size:14px;line-height:1.2;margin-top:.4em}.menu-toggle{display:none}.site-navigation{position:static;visibility:visible}.site-nav-inside{padding:0}.social-links{justify-content:center}.social-links a{margin:0 5px .5em}}@media only screen and (min-width:1001px){.site-header{max-width:300px}.site-header-inside{padding-left:30px;padding-right:30px}}@media only screen and (max-width:800px){.menu--opened .site{height:100%;left:0;overflow:hidden;position:fixed;top:0;transform:translateZ(0);width:100%;z-index:9997}.menu--opened .site-navigation{right:0;transition:right .3s ease-in-out;visibility:visible}}.post{margin-bottom:3.33333em;position:relative}.post-header{margin-bottom:1.66667em}.post-title{font-size:2.66667em;margin:0 0 1.66667rem}.post-title a{border:0;color:inherit}.post-title a:hover{color:#1de2bc}.post-subtitle{font-size:1.33333em;line-height:1.5}.post-image{margin-bottom:1.66667em}.post-image img{width:100%}.post-meta{color:#959ea9;font-size:14px;letter-spacing:1px;line-height:1.5;margin-bottom:1.66667rem;text-transform:uppercase}.post-feed-inside{display:flex;flex-wrap:wrap;margin:0 -.83333em 1.66667em}.post-card{display:flex;flex:0 0 50%;flex-direction:column;margin-bottom:1.66667em;width:50%}.post-card .post-inside{border:1px solid #e9ebed;border-radius:5px;display:flex;flex-direction:column;flex-grow:1;margin-left:.83333em;margin-right:.83333em;overflow:hidden}.post-card .post-thumbnail{border:0;border-radius:5px 5px 0 0;display:block;margin:0;position:relative;width:100%}.post-card .post-thumbnail:before{content:"";display:block;padding-top:66.666%}.post-card .post-thumbnail img{border-radius:5px 5px 0 0;height:100%;left:0;-o-object-fit:cover;object-fit:cover;position:absolute;top:0;width:100%}.post-card .post-header{margin-bottom:.83333rem;padding:1.33333rem 1.33333rem 0}.post-card .post-title{border-bottom:1px solid #e9ebed;font-size:1.33333em;margin:0;padding-bottom:.83333rem}.post-card .post-content{flex-grow:1;font-size:16px;padding:0 1.33333rem}.post-card .post-meta{margin:0;padding:0 1.33333rem 1.33333rem}@media only screen and (max-width:1000px){.post-title{font-size:2.22222em}.post-subtitle{font-size:1.22222em}.post-feed-inside{margin-left:-1.5vw;margin-right:-1.5vw}.post-card{margin-bottom:3vw}.post-card .post-inside{margin-left:1.5vw;margin-right:1.5vw}}@media only screen and (max-width:600px),only screen and (min-width:801px) and (max-width:1000px){.post-card{flex:0 0 100%;width:100%}}.block{margin-bottom:5em}.block-title.underline{color:#33383f;font-size:1em;letter-spacing:.11111em;margin-bottom:1.66667rem;margin-top:0;text-transform:uppercase}.block-image{margin-bottom:1.66667em}.block-image img{width:100%}.block-buttons{align-items:center;display:flex;flex-wrap:wrap}.block-buttons a{margin-bottom:1em;margin-right:15px}.block-hero{margin-bottom:3.33333em}.block-hero .block-title{font-size:2.66667em;margin-bottom:1rem;margin-top:0}.block-hero .block-content{font-size:1.33333em;line-height:1.5}@media only screen and (max-width:1000px){.block{margin-bottom:3.33333em}.block-hero{margin-bottom:2.5em}.block-hero .block-title{font-size:2.22222em}.block-hero .block-content{font-size:1.22222em}}.site-footer{align-items:flex-start;border-top:1px solid #e9ebed;display:flex;padding-top:2.5em}.site-footer .site-info{align-items:center;display:flex;flex-wrap:wrap;flex:1 1;font-size:11px;letter-spacing:.09em;line-height:1.5;margin-bottom:0;text-transform:uppercase}.site-footer .site-info .copyright,.site-footer .site-info>a{font-size:11px;margin-bottom:.5em;margin-right:8px}.site-footer .site-info .button{padding:.58182em 15px}.site-footer .to-top{border:0;color:#555e69;display:none;flex:0 0 auto;height:30px;margin-left:auto;position:relative;width:30px}@media only screen and (max-width:800px){.site-footer .site-info{margin-right:15px}.site-footer .to-top{display:block}}.palette-blue a{border-color:#10bcf9}.palette-blue a:hover{border-color:currentColor}.palette-blue .button,.palette-blue button,.palette-blue input[type=button],.palette-blue input[type=reset],.palette-blue input[type=submit]{background:#10bcf9;border-color:#10bcf9}.palette-blue .button:active,.palette-blue .button:focus,.palette-blue .button:hover,.palette-blue button:active,.palette-blue button:focus,.palette-blue button:hover,.palette-blue input[type=button]:active,.palette-blue input[type=button]:focus,.palette-blue input[type=button]:hover,.palette-blue input[type=reset]:active,.palette-blue input[type=reset]:focus,.palette-blue input[type=reset]:hover,.palette-blue input[type=submit]:active,.palette-blue input[type=submit]:focus,.palette-blue input[type=submit]:hover{background:transparent;border-color:#10bcf9;box-shadow:0 0 1px .5em rgba(16,188,249,.2)}.palette-blue .underline:after{border-color:#10bcf9}.palette-blue .profile .avatar{border-color:#10bcf9;box-shadow:0 0 1px 7px rgba(16,188,249,.2)}@media only screen and (min-width:801px){.palette-blue .profile .avatar{box-shadow:0 0 1px 11px rgba(16,188,249,.2)}}.palette-blue .social-links a:not(.button):hover{color:#10bcf9}.palette-blue .social-links a.button-icon:active,.palette-blue .social-links a.button-icon:focus,.palette-blue .social-links a.button-icon:hover{background:#10bcf9;border-color:#10bcf9;box-shadow:0 0 1px 5px rgba(16,188,249,.2);color:#fff}.palette-blue .menu-item.current-menu-item,.palette-blue .menu-item :not(.button):hover,.palette-blue .post-title a:hover{color:#10bcf9}.palette-blue .site-header.dark .social-links .button-icon:hover{border-color:#10bcf9}.palette-blue .site-header.dark .menu-item .button:active,.palette-blue .site-header.dark .menu-item .button:focus,.palette-blue .site-header.dark .menu-item .button:hover{color:#10bcf9}.palette-violet a{border-color:#9371e6}.palette-violet a:hover{border-color:currentColor}.palette-violet .button,.palette-violet button,.palette-violet input[type=button],.palette-violet input[type=reset],.palette-violet input[type=submit]{background:#9371e6;border-color:#9371e6}.palette-violet .button:active,.palette-violet .button:focus,.palette-violet .button:hover,.palette-violet button:active,.palette-violet button:focus,.palette-violet button:hover,.palette-violet input[type=button]:active,.palette-violet input[type=button]:focus,.palette-violet input[type=button]:hover,.palette-violet input[type=reset]:active,.palette-violet input[type=reset]:focus,.palette-violet input[type=reset]:hover,.palette-violet input[type=submit]:active,.palette-violet input[type=submit]:focus,.palette-violet input[type=submit]:hover{background:transparent;border-color:#9371e6;box-shadow:0 0 1px .5em rgba(147,113,230,.2)}.palette-violet .underline:after{border-color:#9371e6}.palette-violet .profile .avatar{border-color:#9371e6;box-shadow:0 0 1px 7px rgba(147,113,230,.2)}@media only screen and (min-width:801px){.palette-violet .profile .avatar{box-shadow:0 0 1px 11px rgba(147,113,230,.2)}}.palette-violet .social-links a:not(.button):hover{color:#9371e6}.palette-violet .social-links a.button-icon:active,.palette-violet .social-links a.button-icon:focus,.palette-violet .social-links a.button-icon:hover{background:#9371e6;border-color:#9371e6;box-shadow:0 0 1px 5px rgba(147,113,230,.2);color:#fff}.palette-violet .menu-item.current-menu-item,.palette-violet .menu-item :not(.button):hover,.palette-violet .post-title a:hover{color:#9371e6}.palette-violet .site-header.dark .social-links .button-icon:hover{border-color:#9371e6}.palette-violet .site-header.dark .menu-item .button:active,.palette-violet .site-header.dark .menu-item .button:focus,.palette-violet .site-header.dark .menu-item .button:hover{color:#9371e6}.palette-orange a{border-color:#fc6e51}.palette-orange a:hover{border-color:currentColor}.palette-orange .button,.palette-orange button,.palette-orange input[type=button],.palette-orange input[type=reset],.palette-orange input[type=submit]{background:#fc6e51;border-color:#fc6e51}.palette-orange .button:active,.palette-orange .button:focus,.palette-orange .button:hover,.palette-orange button:active,.palette-orange button:focus,.palette-orange button:hover,.palette-orange input[type=button]:active,.palette-orange input[type=button]:focus,.palette-orange input[type=button]:hover,.palette-orange input[type=reset]:active,.palette-orange input[type=reset]:focus,.palette-orange input[type=reset]:hover,.palette-orange input[type=submit]:active,.palette-orange input[type=submit]:focus,.palette-orange input[type=submit]:hover{background:transparent;border-color:#fc6e51;box-shadow:0 0 1px .5em rgba(252,110,81,.2)}.palette-orange .underline:after{border-color:#fc6e51}.palette-orange .profile .avatar{border-color:#fc6e51;box-shadow:0 0 1px 7px rgba(252,110,81,.2)}@media only screen and (min-width:801px){.palette-orange .profile .avatar{box-shadow:0 0 1px 11px rgba(252,110,81,.2)}}.palette-orange .social-links a:not(.button):hover{color:#fc6e51}.palette-orange .social-links a.button-icon:active,.palette-orange .social-links a.button-icon:focus,.palette-orange .social-links a.button-icon:hover{background:#fc6e51;border-color:#fc6e51;box-shadow:0 0 1px 5px rgba(252,110,81,.2);color:#fff}.palette-orange .menu-item.current-menu-item,.palette-orange .menu-item :not(.button):hover,.palette-orange .post-title a:hover{color:#fc6e51}.palette-orange .site-header.dark .social-links .button-icon:hover{border-color:#fc6e51}.palette-orange .site-header.dark .menu-item .button:active,.palette-orange .site-header.dark .menu-item .button:focus,.palette-orange .site-header.dark .menu-item .button:hover{color:#fc6e51}body.has-theme-bar #masthead{top:60px}@media only screen and (max-width:801px){body.has-theme-bar #masthead{top:0}}</style><meta name="generator" content="Gatsby 2.25.4"/><title data-react-helmet="true">ORDER BY &amp; LIMIT (PostgreSQL)</title><link data-react-helmet="true" href="https://fonts.googleapis.com/css?family=Roboto:400,400i,700,700i&amp;display=swap" rel="stylesheet"/><meta data-react-helmet="true" charSet="utf-8"/><meta data-react-helmet="true" name="viewport" content="width=device-width, initialScale=1.0"/><meta data-react-helmet="true" name="google" content="notranslate"/><meta data-react-helmet="true" name="description" content="react start"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="엄마가 좋아? 아빠가 좋아? (MySQL VS PostgreSQL)"/><meta data-react-helmet="true" property="og:description" content="react start"/><meta data-react-helmet="true" property="og:image" content="https://sysnar.github.io/images/jpaLogo.png"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:title" content="React 시작하기"/><meta data-react-helmet="true" name="twitter:description" content="react start"/><meta data-react-helmet="true" name="twitter:image" content="https://sysnar.github.io/images/reactLogo.png"/><link as="script" rel="preload" href="/webpack-runtime-322463cf1e5ce83bc4e6.js"/><link as="script" rel="preload" href="/framework-7c6379e5e4d038106207.js"/><link as="script" rel="preload" href="/app-3fb62d088337e4745a82.js"/><link as="script" rel="preload" href="/styles-7d4153d260c0197f0043.js"/><link as="script" rel="preload" href="/29107295-4fb5befa0a1d6d7d8eb8.js"/><link as="script" rel="preload" href="/commons-90d45c231a2fd67e3613.js"/><link as="script" rel="preload" href="/component---src-templates-post-js-caf21dbe69c519c9d25b.js"/><link as="fetch" rel="preload" href="/page-data/posts/database/order-by-same-value/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div id="page" class="site style-overflow palette-blue"><header id="masthead" class="site-header dark"><div class="site-header-wrap"><div class="site-header-inside"><div class="site-branding"><p class="profile"><a href="/"><img src="/images/profile-avatar.png" class="avatar" alt="Author avatar"/></a></p><div class="site-identity"><p class="site-title"><a href="/">김상윤</a></p><p class="site-description">Web Developer</p></div><button id="menu-toggle" class="menu-toggle"><span class="screen-reader-text">Menu</span><span class="icon-menu" aria-hidden="true"></span></button></div><nav id="main-navigation" class="site-navigation" aria-label="Main Navigation"><div class="site-nav-wrap"><div class="site-nav-inside"><ul class="menu"><li class="menu-item"><a href="/">Home</a></li><li class="menu-item"><a href="/architecture">Architecture</a></li><li class="menu-item"><a href="/database">Database</a></li><li class="menu-item"><a href="/spring">Spring</a></li><li class="menu-item"><a href="/jpa/">Spring Data / JPA</a></li><li class="menu-item"><a href="/devops">DevOps</a></li><li class="menu-item"><a href="/javascript/">javascript</a></li><li class="menu-item"><a href="/typescript/">typescript</a></li><li class="menu-item"><a href="/nestjs/">Nest.js</a></li><li class="menu-item"><a href="/react/">React.js</a></li><li class="menu-item"><a href="/algorithms/">알고리즘</a></li></ul><div class="social-links"><a href="https://github.com/sysnar" target="_blank" rel="noopener " class="button button-icon"><svg class="icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg><span class="screen-reader-text">GitHub</span></a><a href="https://sysnar.xyz/" target="_blank" rel="noopener " class="button button-icon"><svg class="icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6.435 9.444c-0.208-0.155-0.416-0.233-0.624-0.233h-0.934v5.597h0.935c0.208 0 0.416-0.078 0.624-0.233s0.312-0.388 0.312-0.7v-3.731c-0.001-0.311-0.105-0.544-0.312-0.7zM21.649 0h-19.296c-1.296 0-2.349 1.049-2.352 2.346v19.307c0.003 1.297 1.055 2.346 2.352 2.346h19.296c1.297 0 2.349-1.049 2.352-2.346v-19.307c-0.003-1.297-1.055-2.346-2.352-2.346zM8.261 13.885c0 1.008-0.622 2.534-2.591 2.531h-2.486v-8.864h2.538c1.899 0 2.537 1.525 2.538 2.533l0.001 3.8zM13.655 9.136h-2.854v2.058h1.745v1.584h-1.745v2.058h2.855v1.584h-3.331c-0.598 0.016-1.095-0.457-1.11-1.055v-6.702c-0.014-0.597 0.459-1.093 1.056-1.108h3.385l-0.001 1.581zM19.207 15.312c-0.707 1.647-1.974 1.319-2.541 0l-2.064-7.757h1.745l1.592 6.092 1.584-6.092h1.745l-2.060 7.757z"></path></svg><span class="screen-reader-text">DEV</span></a></div></div></div></nav></div></div></header><div id="content" class="site-content"><div class="inner"><main id="main" class="site-main"><article class="post post-full"><header class="post-header inner-sm"><h1 class="post-title underline">ORDER BY &amp; LIMIT (PostgreSQL)</h1></header><div class="post-image"><img src="/images/database-image.jpeg" alt="reactLogo"/></div><div class="post-content inner-sm"><h1>개요</h1><p>회사에서 리더보드를 제작하면서 같은 점수를 획득한 팀이 아래의 예시와 같이 다르게 정렬되는 문제가 있었다.
문제가 발생한 쿼리는 점수를 기준으로 정렬하여 가장 높은 점수를 얻은 팀이 1위가 되도록 조회하는 쿼리였다.  </p><p>아래와 같이 전체 순위를 조회하는 쿼리와 상위 5개 팀만을 조회하는 쿼리의 정렬결과가 다른 것을 볼 수 있다.</p><pre class="grvsc-container dark-default-dark" data-language="" data-index="0"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">-- SELECT * FROM leaderboard ORDER BY score desc</span></span><span class="grvsc-line"><span class="grvsc-source"></span></span><span class="grvsc-line"><span class="grvsc-source">| id | team_name | score |     submit_at     |</span></span><span class="grvsc-line"><span class="grvsc-source">|--------------------------------------------|</span></span><span class="grvsc-line"><span class="grvsc-source">|  1 |  아싸가오리  |  80   |2022-09-06 06:46:19|</span></span><span class="grvsc-line"><span class="grvsc-source">|  2 |  혼자왔어요  |  80   |2022-09-06 06:46:19|</span></span><span class="grvsc-line"><span class="grvsc-source">|  3 |   등차수열  |   80  |2022-09-06 06:46:19|</span></span><span class="grvsc-line"><span class="grvsc-source">|  4 |    ABBA   |  80   |2022-09-06 06:46:19|</span></span><span class="grvsc-line"><span class="grvsc-source">|  5 |    상도덕   |  79   |2022-09-06 06:46:19|</span></span><span class="grvsc-line"><span class="grvsc-source"></span></span><span class="grvsc-line"><span class="grvsc-source">... (+ xxx개)</span></span></code></pre><pre class="grvsc-container dark-default-dark" data-language="" data-index="1"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">-- SELECT * FROM leaderboard ORDER BY score desc LIMIT 5</span></span><span class="grvsc-line"><span class="grvsc-source"></span></span><span class="grvsc-line"><span class="grvsc-source">| id | team_name | score |     submit_at     |</span></span><span class="grvsc-line"><span class="grvsc-source">|--------------------------------------------|</span></span><span class="grvsc-line"><span class="grvsc-source">|  4 |    ABBA   |  80   |2022-09-06 06:46:19|</span></span><span class="grvsc-line"><span class="grvsc-source">|  1 |  아싸가오리  |  80   |2022-09-06 06:46:19|</span></span><span class="grvsc-line"><span class="grvsc-source">|  3 |   등차수열  |   80  |2022-09-06 06:46:19|</span></span><span class="grvsc-line"><span class="grvsc-source">|  2 |  혼자왔어요  |  80   |2022-09-06 06:46:19|</span></span><span class="grvsc-line"><span class="grvsc-source">|  5 |    상도덕   |  79   |2022-09-06 06:46:19|</span></span></code></pre><br/><h1>원인분석</h1><p>이러한 문제가 발생하는 원인은 정렬하고자 하는 순서를 명확하게 제공하지 않았다는 점에 있다.<br/><code class="language-text">ORDER BY</code>의 기준이 되는 컬럼이 고유값을 가지지 않기 때문에 명확하게 정렬되지 않고 옵티마이저가 결정하는 최적의 방법에 따라 정렬된다.<br/>
이때 옵티마이저는 정렬하고자 하는 row의 수 또는 LIMIT 절 존재여부 등에 맞춰 정렬을 위한 최적의 방법을 결정짓는다.  </p><p>이렇게 상황별로 정렬을 위한 방법이 변경되기 때문에 결과값이 무작위로 값이 정렬되는 것으로 보이는 것이다.</p><pre class="grvsc-container dark-default-dark" data-language="" data-index="2"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">   사용자 : 점수를 기준으로 정렬해줘!  </span></span><span class="grvsc-line"><span class="grvsc-source">옵티마이저 : 넵!   </span></span><span class="grvsc-line"><span class="grvsc-source">          (진행중)  </span></span><span class="grvsc-line"><span class="grvsc-source">          엇 중복되는 값이 있네...? </span></span><span class="grvsc-line"><span class="grvsc-source">          정렬하는 row 수도 적은데 빠른 A방법으로 정렬하자!</span></span></code></pre><pre class="grvsc-container dark-default-dark" data-language="" data-index="3"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">   사용자 : 점수를 기준으로 정렬하는데 결과값은 5개만 줘!  </span></span><span class="grvsc-line"><span class="grvsc-source">옵티마이저 : 넵!   </span></span><span class="grvsc-line"><span class="grvsc-source">          (진행중)  </span></span><span class="grvsc-line"><span class="grvsc-source">          엇 중복되는 값이 있는데 ? </span></span><span class="grvsc-line"><span class="grvsc-source">          결과값 제한이 있네~ 이런 경우에는 B방법으로 정렬하자!</span></span></code></pre><br/><h1>해결방법</h1><p>정렬하고자 하는 컬럼에 중복값이 존재한다면 반드시 고유값을 가지는 컬럼을 <code class="language-text">ORDER BY</code> 조건 마지막에 추가해주자.<br/>
아래의 예제처럼 수정해준다면 중복값이 제멋대로 정렬되는 문제를 해결할 수 있을 것이다!</p><pre class="grvsc-container dark-default-dark" data-language="" data-index="4"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">(기존)</span></span><span class="grvsc-line"><span class="grvsc-source">SELECT * FROM leaderboard ORDER BY score desc</span></span><span class="grvsc-line"><span class="grvsc-source"></span></span><span class="grvsc-line"><span class="grvsc-source">(수정) + submit_at 조건 추가</span></span><span class="grvsc-line"><span class="grvsc-source">SELECT * FROM leaderboard ORDER BY score desc, submit_at asc</span></span></code></pre><br/><h1>심층분석</h1><p>그러나 사전적인 지식만을 습득하는 것과 정확한 원인과 동작방식을 이해하는 것은 별개의 일이다. 그렇기 때문에 더 정확한 동작원리를 공부해보자.  </p><p>우선 PostgreSQL의 sort 알고리즘은 아래와 같이 3가지가 있다. 하나씩 차근차근 알아보자.</p><ul><li>Quick Sort </li><li>Heap Sort</li><li>Merge Sort</li></ul><br/><h3>사전 세팅</h3><p>직접적으로 실행계획을 찍어보며 옵티마이저 동작방식을 확인하기 위한 데이터를 생성한다.<br/>
데이터는 <code class="language-text">아이디(id)</code>, <code class="language-text">팀명(team_name)</code>, <code class="language-text">점수(score)</code>, <code class="language-text">제출일(submit_at)</code>로 이루어져있다. 팀명, 점수는 중복될 수 있지만 아이디, 제출일은 중복되지 않는 값으로 채워져있다.</p><pre class="grvsc-container dark-default-dark" data-language="sql" data-index="5"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">-- (1) 테이블 생성</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">CREATE</span><span class="mtk1"> </span><span class="mtk4">TABLE</span><span class="mtk1"> leaderboard(id </span><span class="mtk4">int</span><span class="mtk1">, team_name </span><span class="mtk4">varchar</span><span class="mtk1">(</span><span class="mtk7">20</span><span class="mtk1">), score </span><span class="mtk4">int</span><span class="mtk1">, submit_at </span><span class="mtk4">timestamp</span><span class="mtk1">);</span></span></span><span class="grvsc-line"><span class="grvsc-source"></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">-- (2) 테스트 데이터 삽입 (점수 80점)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">INSERT</span><span class="mtk1"> </span><span class="mtk4">INTO</span><span class="mtk1"> leaderboard(id, team_name, score, submit_at)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">select</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    ids.idx </span><span class="mtk4">as</span><span class="mtk1"> id,</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    array_to_string(ARRAY(</span><span class="mtk4">SELECT</span><span class="mtk1"> chr(</span><span class="mtk7">65</span><span class="mtk1"> + </span><span class="mtk11">round</span><span class="mtk1">(ids.idx % </span><span class="mtk7">26</span><span class="mtk1">) :: </span><span class="mtk4">integer</span><span class="mtk1">) </span><span class="mtk4">FROM</span><span class="mtk1"> generate_series(</span><span class="mtk7">1</span><span class="mtk1">,</span><span class="mtk7">5</span><span class="mtk1">)), </span><span class="mtk8">&#x27;&#x27;</span><span class="mtk1">) </span><span class="mtk4">as</span><span class="mtk1"> team_name,</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk7">80</span><span class="mtk1"> </span><span class="mtk4">as</span><span class="mtk1"> score,</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    (dates.date + interval </span><span class="mtk8">&#x27;2 HOUR&#x27;</span><span class="mtk1"> * ids.idx) </span><span class="mtk4">as</span><span class="mtk1"> submit_at</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">from</span><span class="mtk1"> ( </span><span class="mtk4">select</span><span class="mtk1"> </span><span class="mtk8">&#x27;2022-01-01&#x27;</span><span class="mtk1">::</span><span class="mtk4">date</span><span class="mtk1"> </span><span class="mtk4">as</span><span class="mtk1"> </span><span class="mtk4">date</span><span class="mtk1"> ) dates</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">cross</span><span class="mtk1"> </span><span class="mtk4">join</span><span class="mtk1"> ( </span><span class="mtk4">select</span><span class="mtk1"> generate_series(</span><span class="mtk7">0</span><span class="mtk1">, </span><span class="mtk7">100</span><span class="mtk1">) </span><span class="mtk4">as</span><span class="mtk1"> idx ) ids;</span></span></span><span class="grvsc-line"><span class="grvsc-source"></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">-- (3) 테스트 데이터 삽입 (점수 60점)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">INSERT</span><span class="mtk1"> </span><span class="mtk4">INTO</span><span class="mtk1"> leaderboard(id, team_name, score, submit_at)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">SELECT</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    ids.idx </span><span class="mtk4">AS</span><span class="mtk1"> id,</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    array_to_string(ARRAY(</span><span class="mtk4">SELECT</span><span class="mtk1"> chr(</span><span class="mtk7">65</span><span class="mtk1"> + </span><span class="mtk11">round</span><span class="mtk1">(ids.idx % </span><span class="mtk7">26</span><span class="mtk1">) :: </span><span class="mtk4">integer</span><span class="mtk1">) </span><span class="mtk4">FROM</span><span class="mtk1"> generate_series(</span><span class="mtk7">1</span><span class="mtk1">,</span><span class="mtk7">5</span><span class="mtk1">)), </span><span class="mtk8">&#x27;&#x27;</span><span class="mtk1">) </span><span class="mtk4">AS</span><span class="mtk1"> team_name,</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk7">60</span><span class="mtk1"> </span><span class="mtk4">AS</span><span class="mtk1"> score,</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    (dates.date + interval </span><span class="mtk8">&#x27;2 HOUR&#x27;</span><span class="mtk1"> * ids.idx) </span><span class="mtk4">as</span><span class="mtk1"> submit_at</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">FROM</span><span class="mtk1"> ( </span><span class="mtk4">SELECT</span><span class="mtk1"> </span><span class="mtk8">&#x27;2022-03-01&#x27;</span><span class="mtk1">::</span><span class="mtk4">DATE</span><span class="mtk1"> </span><span class="mtk4">AS</span><span class="mtk1"> </span><span class="mtk4">date</span><span class="mtk1"> ) dates</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">CROSS</span><span class="mtk1"> </span><span class="mtk4">JOIN</span><span class="mtk1"> ( </span><span class="mtk4">SELECT</span><span class="mtk1"> generate_series(</span><span class="mtk7">101</span><span class="mtk1">, </span><span class="mtk7">200</span><span class="mtk1">) </span><span class="mtk4">AS</span><span class="mtk1"> idx ) ids;</span></span></span><span class="grvsc-line"><span class="grvsc-source"></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">-- (4) 테스트 데이터 삽입 (점수 40점)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">INSERT</span><span class="mtk1"> </span><span class="mtk4">INTO</span><span class="mtk1"> leaderboard(id, team_name, score, submit_at)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">SELECT</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    ids.idx </span><span class="mtk4">AS</span><span class="mtk1"> id,</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    array_to_string(ARRAY(</span><span class="mtk4">SELECT</span><span class="mtk1"> chr(</span><span class="mtk7">65</span><span class="mtk1"> + </span><span class="mtk11">round</span><span class="mtk1">(ids.idx % </span><span class="mtk7">26</span><span class="mtk1">) :: </span><span class="mtk4">integer</span><span class="mtk1">) </span><span class="mtk4">FROM</span><span class="mtk1"> generate_series(</span><span class="mtk7">1</span><span class="mtk1">,</span><span class="mtk7">5</span><span class="mtk1">)), </span><span class="mtk8">&#x27;&#x27;</span><span class="mtk1">) </span><span class="mtk4">AS</span><span class="mtk1"> team_name,</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk7">40</span><span class="mtk1"> </span><span class="mtk4">AS</span><span class="mtk1"> score,</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    (dates.date + interval </span><span class="mtk8">&#x27;2 HOUR&#x27;</span><span class="mtk1"> * ids.idx) </span><span class="mtk4">as</span><span class="mtk1"> submit_at</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">FROM</span><span class="mtk1"> ( </span><span class="mtk4">SELECT</span><span class="mtk1"> </span><span class="mtk8">&#x27;2022-06-01&#x27;</span><span class="mtk1">::</span><span class="mtk4">DATE</span><span class="mtk1"> </span><span class="mtk4">AS</span><span class="mtk1"> </span><span class="mtk4">date</span><span class="mtk1"> ) dates</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">CROSS</span><span class="mtk1"> </span><span class="mtk4">JOIN</span><span class="mtk1"> ( </span><span class="mtk4">SELECT</span><span class="mtk1"> generate_series(</span><span class="mtk7">201</span><span class="mtk1">, </span><span class="mtk7">300</span><span class="mtk1">) </span><span class="mtk4">AS</span><span class="mtk1"> idx ) ids;</span></span></span></code></pre><p><img src="../../../images/2022-10-17-22-49-22.png"/></p><br/><hr/><h3>Index Scan</h3><p>인덱스가 걸린 컬럼을 기준으로 <code class="language-text">ORDER BY</code>시 데이터 테이블을 읽지 않고 인덱스 테이블을 읽게 되며 정렬 기준은 인덱스를 따릅니다.</p><ol><li>실습을 위해 생성한 테이블에 인덱스를 생성해준다. </li><li>인덱스가 걸린 <code class="language-text">score</code> 컬럼을 기준으로 정렬하는 쿼리의 실행 계획을 분석한다.  </li><li>인덱스가 적용된 컬럼을 기준으로 정렬을 요청했기 때문에 실행계획에 별도의 정렬로직이 사용하지 않고 있음을 확인할 수 있으며, <code class="language-text">score_idx</code> 인덱스를 기준으로 정렬되었음을 알 수 있다.  </li><li>결과를 확인했으면 인덱스를 지워 이후 쿼리에 영향이 없도록 수정해준다.</li></ol><pre class="grvsc-container dark-default-dark" data-language="sql" data-index="6"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">-- (1) 인덱스 존재 여부 조회 후 없을 경우 생성</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">postgres.public&gt; </span><span class="mtk4">select</span><span class="mtk1"> * </span><span class="mtk4">from</span><span class="mtk1"> pg_indexes </span><span class="mtk4">where</span><span class="mtk1"> tablename= </span><span class="mtk8">&#x27;leaderboard&#x27;</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">postgres.public&gt; </span><span class="mtk4">create</span><span class="mtk1"> index score_idx </span><span class="mtk4">on</span><span class="mtk1"> leaderboard </span><span class="mtk4">using</span><span class="mtk1"> btree(score)</span></span></span><span class="grvsc-line"><span class="grvsc-source"></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">-- (2) 실행계획 조회 &amp; (3) 실행계획 결과</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">postgres.public&gt; EXPLAIN ANALYZE</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">                 </span><span class="mtk4">SELECT</span><span class="mtk1"> ctid, id, team_name, score, submit_at </span><span class="mtk4">FROM</span><span class="mtk1"> leaderboard </span><span class="mtk4">ORDER BY</span><span class="mtk1"> score </span><span class="mtk4">DESC</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">QUERY PLAN</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">---------------------------------------------------------------------------------------------------------------------------</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">Index Scan Backward </span><span class="mtk4">using</span><span class="mtk1"> score_idx </span><span class="mtk4">on</span><span class="mtk1"> leaderboard  (cost=</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">15</span><span class="mtk1">..</span><span class="mtk7">63</span><span class="mtk1">.</span><span class="mtk7">48</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">1301</span><span class="mtk1"> width=</span><span class="mtk7">27</span><span class="mtk1">) (actual </span><span class="mtk4">time</span><span class="mtk1">=</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">013</span><span class="mtk1">..</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">197</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">1301</span><span class="mtk1"> loops=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">Planning </span><span class="mtk4">Time</span><span class="mtk1">: </span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">040</span><span class="mtk1"> ms</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">Execution </span><span class="mtk4">Time</span><span class="mtk1">: </span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">240</span><span class="mtk1"> ms</span></span></span><span class="grvsc-line"><span class="grvsc-source"></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">-- (4) 인덱스 제거</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">postgres.public&gt;  </span><span class="mtk4">drop</span><span class="mtk1"> index score_idx</span></span></span></code></pre><p><img src="../../../images/2022-10-17-22-39-45.png"/></p><br/><hr/><h3>Quick Sort</h3><p>쿼리가 Index를 사용하지 않고 정렬하고자 하는 데이터의 크기가 작을 경우에 옵티마이저는 <code class="language-text">Quick Sort</code> 알고리즘을 선택해 정렬한다.<br/>
* 여기서 데이터의 크기가 작은 경우는 데이터를 정렬하기 위해 필요한 메모리의 크기가 DB에 설정된 <code class="language-text">work_mem</code>보다 작은 경우를 의미한다.<br/>
* <code class="language-text">work_mem</code>이란 PostgreSQL DB가 정렬/해시/조인 등의 작업을 처리할 때 사용할 수 있는 메모리의 크기를 의미하며, 여러 정렬/해시/조인 작업이 함께 일어난다면 각각 메모리가 사용된다.<br/>
* <code class="language-text">work_mem</code>의 기본값은 4MB이며 설정은 1GB / (max_connections * 2) 정도가 적당하다고 한다.
* 예) 1GB / 100 커넥션 = 1024 * ( 100 * 2 ) = 5.12 (MB) = 5MB</p><pre class="grvsc-container dark-default-dark" data-language="sql" data-index="7"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">-- (1) DB에서 정렬 시 사용 가능한 메모리 출력</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">postgres.public&gt; SHOW work_mem</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1"> work_mem</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">------------</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1"> 4MB</span></span></span><span class="grvsc-line"><span class="grvsc-source"></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">-- (2) Quick Sort 정렬 사용</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">postgres.public&gt;  EXPLAIN ANALYZE </span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">                  </span><span class="mtk4">SELECT</span><span class="mtk1"> ctid, id, team_name, score, submit_at </span><span class="mtk4">FROM</span><span class="mtk1"> leaderboard </span><span class="mtk4">ORDER BY</span><span class="mtk1"> score </span><span class="mtk4">DESC</span><span class="mtk1">;</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">   QUERY PLAN</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">---------------------------------------------------------------------------------------------------------------------------</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">Sort  (cost=</span><span class="mtk7">56</span><span class="mtk1">.</span><span class="mtk7">58</span><span class="mtk1">..</span><span class="mtk7">58</span><span class="mtk1">.</span><span class="mtk7">58</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">800</span><span class="mtk1"> width=</span><span class="mtk7">80</span><span class="mtk1">) (actual </span><span class="mtk4">time</span><span class="mtk1">=</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">091</span><span class="mtk1">..</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">103</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">301</span><span class="mtk1"> loops=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  Sort </span><span class="mtk4">Key</span><span class="mtk1">: score </span><span class="mtk4">DESC</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  Sort Method: quicksort  Memory: 48kB</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  -&gt;  Seq Scan </span><span class="mtk4">on</span><span class="mtk1"> leaderboard  (cost=</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">00</span><span class="mtk1">..</span><span class="mtk7">18</span><span class="mtk1">.</span><span class="mtk7">00</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">800</span><span class="mtk1"> width=</span><span class="mtk7">80</span><span class="mtk1">) (actual </span><span class="mtk4">time</span><span class="mtk1">=</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">008</span><span class="mtk1">..</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">041</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">301</span><span class="mtk1"> loops=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">Planning </span><span class="mtk4">Time</span><span class="mtk1">: </span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">057</span><span class="mtk1"> ms</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">Execution </span><span class="mtk4">Time</span><span class="mtk1">: </span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">122</span><span class="mtk1"> ms</span></span></span></code></pre><p>위 쿼리를 실행해보고 실행계획을 간단하게 이해해보면 다음과 같습니다.  </p><ol><li>우리가 테스트하고 있는 DB는 <code class="language-text">work_mem</code>이 4MB로 설정되어 있다.</li><li><code class="language-text">Sort Method: quicksort  Memory: 150kB</code> 부분을 통해 알 수 있듯이 정렬 시 메모리 150kB를 사용하게 된다. </li><li>이때 쿼리는 사용할 수 있는 메모리 크기인 4MB를 초과하지도 않고 LIMIT 조건 또한 존재하지 않기 때문에 옵티마이저는 Quick Sort 알고리즘을 사용해 정렬하게 된다.</li><li>결과적으로 Sort Method로 quicksort가 사용된 것을 확인할 수 있다.</li></ol><p>아래는 Quick Sort를 사용한 조회 쿼리 실행시 출력되는 쿼리 결과입니다.
<img src="../../../images/2022-10-17-23-34-33.png"/></p><br/><hr/><h3>Heap Sort - 1</h3><p>쿼리에 LIMIT 절이 포함되고 정렬하기 위해 필요한 메모리 크기가 <code class="language-text">work_mem</code>보다  작은 경우 옵티마이저는 <code class="language-text">Heap Sort</code> 알고리즘을 선택해 정렬한다.</p><p>앞선 쿼리들과 마찬가지로 실행계획을 분석해보면 아래와 같습니다.</p><ol><li>테스트하고 있는 DB는 work_mem이 4MB로 설정되어 있다.</li><li>다른 것은 모두 동일하지만 쿼리에 LIMIT 절이 사용되었으며, 쿼리 실행 시 메모리는 28kB를 사용한다.</li><li>쿼리는 사용할 수 있는 메모리를 초과하지 않았고, LIMIT 조건이 사용되었기 때문에 옵티마이저는 Heap Sort 알고리즘을 사용하도록 결정한다.</li><li>결과적으로 Sort Method로는 top-N heapsort가 사용된 것을 확인할 수 있다.</li></ol><pre class="grvsc-container dark-default-dark" data-language="sql" data-index="8"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">-- (1) DB에서 정렬 시 사용 가능한 메모리 출력</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">postgres.public&gt; SHOW work_mem</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1"> work_mem</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">------------</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1"> 4MB</span></span></span><span class="grvsc-line"><span class="grvsc-source"></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">-- (2) Heap Sort 정렬 사용 (LIMIT 10 &amp; OFFSET 0)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">postgres.public&gt;  EXPLAIN ANALYZE</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">                  </span><span class="mtk4">SELECT</span><span class="mtk1"> ctid, id, team_name, score, submit_at </span><span class="mtk4">FROM</span><span class="mtk1"> leaderboard </span><span class="mtk4">ORDER BY</span><span class="mtk1"> score </span><span class="mtk4">DESC</span><span class="mtk1"> </span><span class="mtk4">LIMIT</span><span class="mtk1"> </span><span class="mtk7">10</span><span class="mtk1"> OFFSET </span><span class="mtk7">0</span><span class="mtk1">;</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">QUERY PLAN</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">---------------------------------------------------------------------------------------------------------------------------</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">Limit</span><span class="mtk1">  (cost=</span><span class="mtk7">11</span><span class="mtk1">.</span><span class="mtk7">51</span><span class="mtk1">..</span><span class="mtk7">11</span><span class="mtk1">.</span><span class="mtk7">54</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">10</span><span class="mtk1"> width=</span><span class="mtk7">28</span><span class="mtk1">) (actual </span><span class="mtk4">time</span><span class="mtk1">=</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">096</span><span class="mtk1">..</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">098</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">10</span><span class="mtk1"> loops=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  -&gt;  Sort  (cost=</span><span class="mtk7">11</span><span class="mtk1">.</span><span class="mtk7">51</span><span class="mtk1">..</span><span class="mtk7">12</span><span class="mtk1">.</span><span class="mtk7">27</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">301</span><span class="mtk1"> width=</span><span class="mtk7">28</span><span class="mtk1">) (actual </span><span class="mtk4">time</span><span class="mtk1">=</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">095</span><span class="mtk1">..</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">096</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">10</span><span class="mtk1"> loops=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        Sort </span><span class="mtk4">Key</span><span class="mtk1">: score </span><span class="mtk4">DESC</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        Sort Method: </span><span class="mtk4">top</span><span class="mtk1">-N heapsort  Memory: 25kB</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        -&gt;  Seq Scan </span><span class="mtk4">on</span><span class="mtk1"> leaderboard  (cost=</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">00</span><span class="mtk1">..</span><span class="mtk7">5</span><span class="mtk1">.</span><span class="mtk7">01</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">301</span><span class="mtk1"> width=</span><span class="mtk7">28</span><span class="mtk1">) (actual </span><span class="mtk4">time</span><span class="mtk1">=</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">010</span><span class="mtk1">..</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">044</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">301</span><span class="mtk1"> loops=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">Planning </span><span class="mtk4">Time</span><span class="mtk1">: </span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">042</span><span class="mtk1"> ms</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">Execution </span><span class="mtk4">Time</span><span class="mtk1">: </span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">111</span><span class="mtk1"> ms</span></span></span></code></pre><p>이제 조회 결과를 봐보면 앞서서 Quick Sort를 사용해 정렬했을 때와는 달리 뭔가 다른 점이 있는 것 알 수 있다. 첫번째 row에 있던 <code class="language-text">ctid(0,1)</code>이 가장 뒤로 빠지게 되었다.<br/>
쿼리에 LIMIT, OFFSET 조건이 추가됨에 따라 정렬 알고리즘이 <code class="language-text">Quick Sort</code>에서 <code class="language-text">Heap Sort</code>로 바뀌게 되었고, 이에 따라 정렬 결과도 바뀌게 된 것이다.</p><p><img src="../../../images/2022-10-18-00-09-34.png"/></p><br/><h3>Heap Sort - 2</h3><p>여기서 더 나아가서 OFFSET 값을 바꾸어 정렬해보면 다음과 같은 결과가 나오는 것을 확인할 수 있다.
예상대로라면 <code class="language-text">ctid(0,11)</code>이 첫번째로 조회되어야 하지만 이전 페이지에서 조회되었던 ctid(0,1) 중복 조회되는 것을 확인할 수 있다. 이러한 문제의 가장 큰 원인은 <code class="language-text">Quick Sort</code>와 <code class="language-text">Heap Sort</code>가 같은 값을 항상 똑같은 결과대로 정렬하지 못하는 <code class="language-text">Unstable Sorting</code>이기 때문이다.  </p><p>결과적으로 리더보드의 순서가 다르게 출력된 원인은 이렇게 2가지였음을 알게 되었다.</p><ol><li>다른 알고리즘을 사용한 정렬</li><li>Unstable Sorting 알고리즘</li></ol><pre class="grvsc-container dark-default-dark" data-language="sql" data-index="9"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">-- (3) Heap Sort 정렬 사용 (LIMIT 10 &amp; OFFSET 10)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">postgres.public&gt;  EXPLAIN ANALYZE</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">                  </span><span class="mtk4">SELECT</span><span class="mtk1"> ctid, id, team_name, score, submit_at </span><span class="mtk4">FROM</span><span class="mtk1"> leaderboard </span><span class="mtk4">ORDER BY</span><span class="mtk1"> score </span><span class="mtk4">DESC</span><span class="mtk1"> </span><span class="mtk4">LIMIT</span><span class="mtk1"> </span><span class="mtk7">10</span><span class="mtk1"> OFFSET </span><span class="mtk7">10</span><span class="mtk1">;</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">QUERY PLAN</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">---------------------------------------------------------------------------------------------------------------------------</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">Limit</span><span class="mtk1">  (cost=</span><span class="mtk7">13</span><span class="mtk1">.</span><span class="mtk7">04</span><span class="mtk1">..</span><span class="mtk7">13</span><span class="mtk1">.</span><span class="mtk7">07</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">10</span><span class="mtk1"> width=</span><span class="mtk7">28</span><span class="mtk1">) (actual </span><span class="mtk4">time</span><span class="mtk1">=</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">097</span><span class="mtk1">..</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">099</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">10</span><span class="mtk1"> loops=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  -&gt;  Sort  (cost=</span><span class="mtk7">13</span><span class="mtk1">.</span><span class="mtk7">02</span><span class="mtk1">..</span><span class="mtk7">13</span><span class="mtk1">.</span><span class="mtk7">77</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">301</span><span class="mtk1"> width=</span><span class="mtk7">28</span><span class="mtk1">) (actual </span><span class="mtk4">time</span><span class="mtk1">=</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">096</span><span class="mtk1">..</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">097</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">20</span><span class="mtk1"> loops=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        Sort </span><span class="mtk4">Key</span><span class="mtk1">: score </span><span class="mtk4">DESC</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        Sort Method: </span><span class="mtk4">top</span><span class="mtk1">-N heapsort  Memory: 26kB</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        -&gt;  Seq Scan </span><span class="mtk4">on</span><span class="mtk1"> leaderboard  (cost=</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">00</span><span class="mtk1">..</span><span class="mtk7">5</span><span class="mtk1">.</span><span class="mtk7">01</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">301</span><span class="mtk1"> width=</span><span class="mtk7">28</span><span class="mtk1">) (actual </span><span class="mtk4">time</span><span class="mtk1">=</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">010</span><span class="mtk1">..</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">044</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">301</span><span class="mtk1"> loops=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">Planning </span><span class="mtk4">Time</span><span class="mtk1">: </span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">041</span><span class="mtk1"> ms</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">Execution </span><span class="mtk4">Time</span><span class="mtk1">: </span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">111</span><span class="mtk1"> ms</span></span></span></code></pre><p><img src="../../../images/2022-10-18-00-14-05.png"/></p><br/><hr/><h3>Merge Sort</h3><p>정렬 시 필요한 데이터의 크기가 <code class="language-text">work_mem</code>보다 클 경우 옵티마이저는 <code class="language-text">Merge Sort</code> 알고리즘을 선택해 정렬한다.<br/>
이를 확인해보기 위해서 db의 <code class="language-text">work_mem</code>을 아래와 같이 줄이고 테스트 해보면 예상대로 실행계획이 Merge Sort를 사용해 정렬하는 것을 확인할 수 있다.</p><pre class="grvsc-container dark-default-dark" data-language="sql" data-index="10"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">-- (1) 많은 테스트 데이터 삽입 (점수 20점)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">INSERT</span><span class="mtk1"> </span><span class="mtk4">INTO</span><span class="mtk1"> leaderboard(id, team_name, score, submit_at)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">SELECT</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    ids.idx </span><span class="mtk4">AS</span><span class="mtk1"> id,</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    array_to_string(ARRAY(</span><span class="mtk4">SELECT</span><span class="mtk1"> chr(</span><span class="mtk7">65</span><span class="mtk1"> + </span><span class="mtk11">round</span><span class="mtk1">(ids.idx % </span><span class="mtk7">26</span><span class="mtk1">) :: </span><span class="mtk4">integer</span><span class="mtk1">) </span><span class="mtk4">FROM</span><span class="mtk1"> generate_series(</span><span class="mtk7">1</span><span class="mtk1">,</span><span class="mtk7">5</span><span class="mtk1">)), </span><span class="mtk8">&#x27;&#x27;</span><span class="mtk1">) </span><span class="mtk4">AS</span><span class="mtk1"> team_name,</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk7">20</span><span class="mtk1"> </span><span class="mtk4">AS</span><span class="mtk1"> score,</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    (dates.date + interval </span><span class="mtk8">&#x27;1 HOUR&#x27;</span><span class="mtk1"> * ids.idx) </span><span class="mtk4">as</span><span class="mtk1"> submit_at</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">FROM</span><span class="mtk1"> ( </span><span class="mtk4">SELECT</span><span class="mtk1"> </span><span class="mtk8">&#x27;2022-09-01&#x27;</span><span class="mtk1">::</span><span class="mtk4">DATE</span><span class="mtk1"> </span><span class="mtk4">AS</span><span class="mtk1"> </span><span class="mtk4">date</span><span class="mtk1"> ) dates</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">CROSS</span><span class="mtk1"> </span><span class="mtk4">JOIN</span><span class="mtk1"> ( </span><span class="mtk4">SELECT</span><span class="mtk1"> generate_series(</span><span class="mtk7">301</span><span class="mtk1">, </span><span class="mtk7">13000</span><span class="mtk1">) </span><span class="mtk4">AS</span><span class="mtk1"> idx ) ids;</span></span></span><span class="grvsc-line"><span class="grvsc-source"></span></span><span class="grvsc-line"><span class="grvsc-source"></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">-- (2) 사용 가능한 work_mem 확인 및 축소</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">postgres.public&gt; SHOW work_mem;</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1"> work_mem</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">------------</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1"> 4MB</span></span></span><span class="grvsc-line"><span class="grvsc-source"></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">postgres.public&gt; </span><span class="mtk4">SET</span><span class="mtk1"> work_mem = </span><span class="mtk8">&#x27;64kB&#x27;</span><span class="mtk1">;</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">postgres.public&gt; SHOW work_mem;</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1"> work_mem</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">------------</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1"> 64kB</span></span></span><span class="grvsc-line"><span class="grvsc-source"></span></span><span class="grvsc-line"><span class="grvsc-source"></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1"> </span><span class="mtk3">-- (3) 많은 테스트 데이터 삽입 (점수 20점)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">postgres.public&gt; EXPLAIN ANALYZE</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">                 </span><span class="mtk4">SELECT</span><span class="mtk1"> ctid, id, team_name, score, submit_at </span><span class="mtk4">FROM</span><span class="mtk1"> leaderboard </span><span class="mtk4">ORDER BY</span><span class="mtk1"> score </span><span class="mtk4">DESC</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">QUERY PLAN</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">---------------------------------------------------------------------------------------------------------------------------</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">Sort  (cost=</span><span class="mtk7">120</span><span class="mtk1">.</span><span class="mtk7">81</span><span class="mtk1">..</span><span class="mtk7">124</span><span class="mtk1">.</span><span class="mtk7">06</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">1301</span><span class="mtk1"> width=</span><span class="mtk7">28</span><span class="mtk1">) (actual </span><span class="mtk4">time</span><span class="mtk1">=</span><span class="mtk7">15</span><span class="mtk1">.</span><span class="mtk7">185</span><span class="mtk1">..</span><span class="mtk7">21</span><span class="mtk1">.</span><span class="mtk7">683</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">1301</span><span class="mtk1"> loops=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  Sort </span><span class="mtk4">Key</span><span class="mtk1">: score </span><span class="mtk4">DESC</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  Sort Method: </span><span class="mtk4">external</span><span class="mtk1"> </span><span class="mtk4">merge</span><span class="mtk1">  </span><span class="mtk4">Disk</span><span class="mtk1">: 64kB</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  -&gt;  Seq Scan </span><span class="mtk4">on</span><span class="mtk1"> leaderboard  (cost=</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">00</span><span class="mtk1">..</span><span class="mtk7">22</span><span class="mtk1">.</span><span class="mtk7">01</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">1301</span><span class="mtk1"> width=</span><span class="mtk7">28</span><span class="mtk1">) (actual </span><span class="mtk4">time</span><span class="mtk1">=</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">015</span><span class="mtk1">..</span><span class="mtk7">7</span><span class="mtk1">.</span><span class="mtk7">351</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">1301</span><span class="mtk1"> loops=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">Planning </span><span class="mtk4">Time</span><span class="mtk1">: </span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">044</span><span class="mtk1"> ms</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">Execution </span><span class="mtk4">Time</span><span class="mtk1">: </span><span class="mtk7">27</span><span class="mtk1">.</span><span class="mtk7">902</span><span class="mtk1"> ms</span></span></span></code></pre><p>여기에 Merge Sort에는 다른 정렬과는 다르게 Stable Sorting이라는 특징이 있다.
아래 사진을 통해 보면 <code class="language-text">Heap Sort</code>는 무작위로 값이 정렬되는 반면, <code class="language-text">Merge Sort</code>는 항상 정해진 값을 내려주는 사실을 확인할 수 있다.<br/>
(ctid 값을 보면 1번은 뒤죽박죽으로 섞여있지만, 2번은 일관된 순서로 조회되고 있음을 알 수 있다.)</p><p><img src="../../../images/2022-10-20-14-46-34.png"/><br/>
(1. Heap Sort를 사용한 경우)</p><p><img src="../../../images/2022-10-20-14-48-09.png"/>
(2. Merge Sort를 사용한 경우)</p><p>마지막으로 하나 더 알아두어야 할 것이 있는데 바로 OFFSET 값 증가에 따른 사용 메모리양 증가다. LIMIT 값이 10으로 고정되어 있더라도 OFFSET 값이 바뀜에 따라 쿼리 실행에 필요한 메모리 크기가 달라질 수 있다.<br/>
이해를 위해 예시를 들어 설명하면 페이징 처리 시 페이지 수가 낮은 경우에는 <code class="language-text">Heap Sort</code>가 적용되다가 페이지 수가 많아져 OFFSET 같이 커지는 경우 <code class="language-text">Merge Sort</code>가 적용되어 조회되는 게시물의 순서가 뒤바뀌는 문제가 발생할 수도 있다.   </p><pre class="grvsc-container dark-default-dark" data-language="sql" data-index="11"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">-- (1) LIMIT 200, OFFSET 0 (Memory: 40kB)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">postgres.public&gt; EXPLAIN ANALYZE</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">                 </span><span class="mtk4">SELECT</span><span class="mtk1"> ctid, id, team_name, score, submit_at </span><span class="mtk4">FROM</span><span class="mtk1"> leaderboard </span><span class="mtk4">ORDER BY</span><span class="mtk1"> score </span><span class="mtk4">DESC</span><span class="mtk1"> </span><span class="mtk4">LIMIT</span><span class="mtk1"> </span><span class="mtk7">200</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">QUERY PLAN</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">---------------------------------------------------------------------------------------------------------------------------</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">Limit</span><span class="mtk1">  (cost=</span><span class="mtk7">78</span><span class="mtk1">.</span><span class="mtk7">24</span><span class="mtk1">..</span><span class="mtk7">78</span><span class="mtk1">.</span><span class="mtk7">74</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">200</span><span class="mtk1"> width=</span><span class="mtk7">28</span><span class="mtk1">) (actual </span><span class="mtk4">time</span><span class="mtk1">=</span><span class="mtk7">14</span><span class="mtk1">.</span><span class="mtk7">929</span><span class="mtk1">..</span><span class="mtk7">17</span><span class="mtk1">.</span><span class="mtk7">647</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">200</span><span class="mtk1"> loops=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  -&gt;  Sort  (cost=</span><span class="mtk7">78</span><span class="mtk1">.</span><span class="mtk7">24</span><span class="mtk1">..</span><span class="mtk7">81</span><span class="mtk1">.</span><span class="mtk7">49</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">1301</span><span class="mtk1"> width=</span><span class="mtk7">28</span><span class="mtk1">) (actual </span><span class="mtk4">time</span><span class="mtk1">=</span><span class="mtk7">14</span><span class="mtk1">.</span><span class="mtk7">918</span><span class="mtk1">..</span><span class="mtk7">15</span><span class="mtk1">.</span><span class="mtk7">846</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">200</span><span class="mtk1"> loops=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        Sort </span><span class="mtk4">Key</span><span class="mtk1">: score </span><span class="mtk4">DESC</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        Sort Method: </span><span class="mtk4">top</span><span class="mtk1">-N heapsort  Memory: 40kB</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        -&gt;  Seq Scan </span><span class="mtk4">on</span><span class="mtk1"> leaderboard  (cost=</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">00</span><span class="mtk1">..</span><span class="mtk7">22</span><span class="mtk1">.</span><span class="mtk7">01</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">1301</span><span class="mtk1"> width=</span><span class="mtk7">28</span><span class="mtk1">) (actual </span><span class="mtk4">time</span><span class="mtk1">=</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">014</span><span class="mtk1">..</span><span class="mtk7">7</span><span class="mtk1">.</span><span class="mtk7">430</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">1301</span><span class="mtk1"> loops=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">Planning </span><span class="mtk4">Time</span><span class="mtk1">: </span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">050</span><span class="mtk1"> ms</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">Execution </span><span class="mtk4">Time</span><span class="mtk1">: </span><span class="mtk7">18</span><span class="mtk1">.</span><span class="mtk7">598</span><span class="mtk1"> ms</span></span></span><span class="grvsc-line"><span class="grvsc-source"></span></span><span class="grvsc-line"><span class="grvsc-source"></span></span><span class="grvsc-line"><span class="grvsc-source"></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">-- (2) LIMIT 200, OFFSET 1000 (Memory: 560kB)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">postgres.public&gt; EXPLAIN ANALYZE</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">                 </span><span class="mtk4">SELECT</span><span class="mtk1"> ctid, id, team_name, score, submit_at </span><span class="mtk4">FROM</span><span class="mtk1"> leaderboard </span><span class="mtk4">ORDER BY</span><span class="mtk1"> score </span><span class="mtk4">DESC</span><span class="mtk1"> </span><span class="mtk4">LIMIT</span><span class="mtk1"> </span><span class="mtk7">200</span><span class="mtk1"> OFFSET </span><span class="mtk7">1000</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">QUERY PLAN</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">---------------------------------------------------------------------------------------------------------------------------</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">Limit</span><span class="mtk1">  (cost=</span><span class="mtk7">2258</span><span class="mtk1">.</span><span class="mtk7">56</span><span class="mtk1">..</span><span class="mtk7">2258</span><span class="mtk1">.</span><span class="mtk7">68</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">10</span><span class="mtk1"> width=</span><span class="mtk7">28</span><span class="mtk1">) (actual </span><span class="mtk4">time</span><span class="mtk1">=</span><span class="mtk7">135</span><span class="mtk1">.</span><span class="mtk7">169</span><span class="mtk1">..</span><span class="mtk7">135</span><span class="mtk1">.</span><span class="mtk7">420</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">10</span><span class="mtk1"> loops=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  -&gt;  </span><span class="mtk4">Limit</span><span class="mtk1">  (cost=</span><span class="mtk7">2258</span><span class="mtk1">.</span><span class="mtk7">56</span><span class="mtk1">..</span><span class="mtk7">2259</span><span class="mtk1">.</span><span class="mtk7">06</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">200</span><span class="mtk1"> width=</span><span class="mtk7">28</span><span class="mtk1">) (actual </span><span class="mtk4">time</span><span class="mtk1">=</span><span class="mtk7">135</span><span class="mtk1">.</span><span class="mtk7">159</span><span class="mtk1">..</span><span class="mtk7">135</span><span class="mtk1">.</span><span class="mtk7">331</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">10</span><span class="mtk1"> loops=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        -&gt;  Sort  (cost=</span><span class="mtk7">2256</span><span class="mtk1">.</span><span class="mtk7">06</span><span class="mtk1">..</span><span class="mtk7">2297</span><span class="mtk1">.</span><span class="mtk7">92</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">16743</span><span class="mtk1"> width=</span><span class="mtk7">28</span><span class="mtk1">) (actual </span><span class="mtk4">time</span><span class="mtk1">=</span><span class="mtk7">126</span><span class="mtk1">.</span><span class="mtk7">884</span><span class="mtk1">..</span><span class="mtk7">130</span><span class="mtk1">.</span><span class="mtk7">991</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">1010</span><span class="mtk1"> loops=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">              Sort </span><span class="mtk4">Key</span><span class="mtk1">: leaderboard.score </span><span class="mtk4">DESC</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">              Sort Method: </span><span class="mtk4">external</span><span class="mtk1"> </span><span class="mtk4">merge</span><span class="mtk1">  </span><span class="mtk4">Disk</span><span class="mtk1">: 560kB</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">              -&gt;  Seq Scan </span><span class="mtk4">on</span><span class="mtk1"> leaderboard  (cost=</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">00</span><span class="mtk1">..</span><span class="mtk7">276</span><span class="mtk1">.</span><span class="mtk7">43</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">16743</span><span class="mtk1"> width=</span><span class="mtk7">28</span><span class="mtk1">) (actual </span><span class="mtk4">time</span><span class="mtk1">=</span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">012</span><span class="mtk1">..</span><span class="mtk7">61</span><span class="mtk1">.</span><span class="mtk7">390</span><span class="mtk1"> </span><span class="mtk4">rows</span><span class="mtk1">=</span><span class="mtk7">13001</span><span class="mtk1"> loops=</span><span class="mtk7">1</span><span class="mtk1">)</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">Planning </span><span class="mtk4">Time</span><span class="mtk1">: </span><span class="mtk7">0</span><span class="mtk1">.</span><span class="mtk7">092</span><span class="mtk1"> ms</span></span></span><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">Execution </span><span class="mtk4">Time</span><span class="mtk1">: </span><span class="mtk7">135</span><span class="mtk1">.</span><span class="mtk7">661</span><span class="mtk1"> ms</span></span></span></code></pre><br/><h1>결론</h1><ol><li>중복값이 존재하는 컬럼을 기준으로 정렬할 경우 꼭 UNIQUE 한 값을 가지는 컬럼을 ORDER BY 조건 뒤에 추가해줘야 조회 시 데이터가 잘못 정렬되는 경우를 방지할 수 있다.</li><li>해결 방법은 비교적 간단한(?) 문제였지만 문제가 발생하는 근본적인 이유, 그 이유로 인해 발생할 수 있는 사이드 이펙트 등을 고려하는 건 다른 문제라는 걸 깨닳았다.</li><li>복잡한 쿼리를 짤 때는 항상 실행계획을 통해 쿼리가 내가 의도한 대로 동작하는 지 확인하는 작업이 필요할 것 같다.</li><li>단순히 CRUD 수준의 Database 지식이 멈추지 말고 실제 동작원리 수준을 이해하고 사용해야 진정 &quot;이해했다&quot;라고 할 수 있을 것 같다. 문제 해결에만 집중하지 말고 해결과정, 해결 후 개선방안에도 집중해서 공부하는 사람이 되자.</li></ol><p>출처 :
<a href="https://www.reddit.com/r/PostgreSQL/comments/ni2l9u/why_is_a_query_with_limit_returning_results_in_a/">레딧 질문글1</a><br/><a href="https://stackoverflow.com/questions/13580826/postgresql-repeating-rows-from-limit-offset">레딧 질문글2</a><br/><a href="https://libreflare.com/9911649250298">PostgreSQL 정렬 알고리즘</a><br/><a href="https://www.postgresql.org/docs/14/queries-limit.html">PostgreSQL limit 공식문서</a></p><style class="grvsc-styles">
  .grvsc-container {
    overflow: auto;
    position: relative;
    -webkit-overflow-scrolling: touch;
    padding-top: 1rem;
    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));
    padding-bottom: 1rem;
    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));
    border-radius: 8px;
    border-radius: var(--grvsc-border-radius, 8px);
    font-feature-settings: normal;
    line-height: 1.4;
  }
  
  .grvsc-code {
    display: table;
  }
  
  .grvsc-line {
    display: table-row;
    box-sizing: border-box;
    width: 100%;
    position: relative;
  }
  
  .grvsc-line &gt; * {
    position: relative;
  }
  
  .grvsc-gutter-pad {
    display: table-cell;
    padding-left: 0.75rem;
    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);
  }
  
  .grvsc-gutter {
    display: table-cell;
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  
  .grvsc-gutter::before {
    content: attr(data-content);
  }
  
  .grvsc-source {
    display: table-cell;
    padding-left: 1.5rem;
    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));
    padding-right: 1.5rem;
    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));
  }
  
  .grvsc-source:empty::after {
    content: &#x27; &#x27;;
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  
  .grvsc-gutter + .grvsc-source {
    padding-left: 0.75rem;
    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);
  }
  
  /* Line transformer styles */
  
  .grvsc-has-line-highlighting &gt; .grvsc-code &gt; .grvsc-line::before {
    content: &#x27; &#x27;;
    position: absolute;
    width: 100%;
  }
  
  .grvsc-line-diff-add::before {
    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));
  }
  
  .grvsc-line-diff-del::before {
    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));
  }
  
  .grvsc-line-number {
    padding: 0 2px;
    text-align: right;
    opacity: 0.7;
  }
  
  .dark-default-dark {
    background-color: #1E1E1E;
    color: #D4D4D4;
  }
  .dark-default-dark .mtk3 { color: #6A9955; }
  .dark-default-dark .mtk4 { color: #569CD6; }
  .dark-default-dark .mtk1 { color: #D4D4D4; }
  .dark-default-dark .mtk7 { color: #B5CEA8; }
  .dark-default-dark .mtk11 { color: #DCDCAA; }
  .dark-default-dark .mtk8 { color: #CE9178; }
  .dark-default-dark .grvsc-line-highlighted::before {
    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));
    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));
  }
</style></div><footer class="post-meta inner-sm"><time class="published" dateTime="2022-10-12 00:00">Wednesday, October 12, 2022</time></footer></article></main><footer id="colophon" class="site-footer inner-sm"><p class="site-info"><span class="copyright">@contact: sysn4r@gmail.com</span></p><a href="#page" id="to-top" class="to-top"><span class="icon-arrow-up" aria-hidden="true"></span><span class="screen-reader-text">Back to top</span></a></footer></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script src="/js/init.js"></script><script src="/js/page-load.js"></script><script src="/js/page-unload.js"></script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/posts/database/order-by-same-value/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-c3eb355c796a54396950.js"],"app":["/app-3fb62d088337e4745a82.js"],"component---src-templates-advanced-js":["/component---src-templates-advanced-js-4f61ad3af0199cd4262d.js"],"component---src-templates-algorithms-js":["/component---src-templates-algorithms-js-12a892b6f1b8120d2355.js"],"component---src-templates-architecture-js":["/component---src-templates-architecture-js-6f4ee228043f875bf3fd.js"],"component---src-templates-blog-js":["/component---src-templates-blog-js-aacd3a1cac637a9ba7e0.js"],"component---src-templates-database-js":["/component---src-templates-database-js-8f95343f2df7a11de5e2.js"],"component---src-templates-devops-js":["/component---src-templates-devops-js-317fc3ce8806a7ce3851.js"],"component---src-templates-javascript-js":["/component---src-templates-javascript-js-f32d4b6a451caef15dfe.js"],"component---src-templates-jpa-js":["/component---src-templates-jpa-js-771c0992449e359a64fe.js"],"component---src-templates-nestjs-js":["/component---src-templates-nestjs-js-430f74bbc9b06cff301c.js"],"component---src-templates-page-js":["/component---src-templates-page-js-fe6465205eb72a40c2b5.js"],"component---src-templates-post-js":["/component---src-templates-post-js-caf21dbe69c519c9d25b.js"],"component---src-templates-react-js":["/component---src-templates-react-js-f83572963e5a75cee96d.js"],"component---src-templates-spring-js":["/component---src-templates-spring-js-4fcf06fa5d4363a13031.js"],"component---src-templates-typescript-js":["/component---src-templates-typescript-js-29e467d49955434aa60a.js"]};/*]]>*/</script><script src="/polyfill-c3eb355c796a54396950.js" nomodule=""></script><script src="/component---src-templates-post-js-caf21dbe69c519c9d25b.js" async=""></script><script src="/commons-90d45c231a2fd67e3613.js" async=""></script><script src="/29107295-4fb5befa0a1d6d7d8eb8.js" async=""></script><script src="/styles-7d4153d260c0197f0043.js" async=""></script><script src="/app-3fb62d088337e4745a82.js" async=""></script><script src="/framework-7c6379e5e4d038106207.js" async=""></script><script src="/webpack-runtime-322463cf1e5ce83bc4e6.js" async=""></script></body></html>